const gayware={api:{version:65536,endpoint:document.location.protocol+'//'+document.location.host+'/api',io:{ajax:function(settings,path,callback){let request=$.ajax({url:gayware.api.endpoint+path,type:settings.type,data:settings.data,dataType:'json',contentType:'application/json',}).done(function(resp){callback(resp);});},get:function(path,callback){gayware.api.io.ajax({type:'GET'},path,callback);},post:function(path,data,callback){console.log(JSON.stringify(data));gayware.api.io.ajax({type:'POST',data:JSON.stringify(data)},path,callback);},},call:{version:function(callback){gayware.api.io.get('/version',function(data){callback(data);});},board:{read:function(fid,callback){let args={fid:fid};gayware.api.io.post('/board/read',args,callback);}},thread:{close:function(tid,status,token,callback){let args={tid:tid,status:status,token:token};gayware.api.io.post('/thread/close',args,callback);},approve:function(tid,approve,token,callback){let args={tid:tid,approve:approve,token:token};gayware.api.io.post('/thread/approve',args,callback);},delete:function(tid,token,callback){let args={tid:tid,token:token};gayware.api.io.post('/thread/delete',args,callback);},stick:function(tid,stick,token,callback){let args={tid:tid,stick:stick,token:token};gayware.api.io.post('/thread/stick',args,callback);}},user:{ban:function(uid,time,reason,token,callback){let args={uid:uid,time:time,reason:reason,token:token};gayware.api.io.post('/user/ban',args,callback);},search:function(username,callback){let args={username:username};gayware.api.io.post('/user/search',args,callback);},note:function(uid,notes,token,callback){let args={token:token,uid:uid,notes:notes};gayware.api.io.post('/user/note',args,callback);},message:{delete:function(pmid,token,callback){let args={pmid:pmid,token:token};gayware.api.io.post('/user/message/delete',args,callback);}}},post:{approve:function(pid,approve,token,callback){let args={pid:pid,approve:approve,token:token};gayware.api.io.post('/post/approve',args,callback);},delete:function(pid,token,callback){let args={pid:pid,token:token};gayware.api.io.post('/post/delete',args,callback);}},},},cookie:{get:function(name){if(document.cookie){let f=document.cookie.split('; ').find(row=>row.startsWith(name));if(typeof f!=='undefined'){return f.split('=')[1];}}
return undefined;},set:function(name,value){document.cookie=name+'='+value+'; SameSite=Lax; path=/;';}},ui:{register:function(){$(function(){$('[data-post-delete]').on('click',gayware.ui.post.delete);$('[data-post-approve]').on('click',gayware.ui.post.approve);$('[data-thread-close]').on('click',gayware.ui.thread.close);$('[data-thread-stick]').on('click',gayware.ui.thread.stick);$('[data-thread-delete]').on('click',gayware.ui.thread.delete);$('[data-thread-approve]').on('click',gayware.ui.thread.approve);$('[data-board-read]').on('click',gayware.ui.board.read);$('[data-board-collapse]').on('click',gayware.ui.board.collapse.handle).ready(gayware.ui.board.collapse.init);$('[data-user-message-delete]').on('click',gayware.ui.user.message.delete);$('[data-user-ban-form]').on('submit',gayware.ui.user.ban);$('[data-user-note-form]').on('submit',gayware.ui.user.note);});},user:{ban:function(){let frmSubmit=$(this);let tokenValue=frmSubmit.data('token');let userIdValue=frmSubmit.data('uid');let timeValue=$("#userban-time option:selected").val();let reasonValue=$("#userban-reason").val();gayware.api.call.user.ban(userIdValue,timeValue,reasonValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});return false;},note:function(){let frmSubmit=$(this);let tokenValue=frmSubmit.data('token');let userIdValue=frmSubmit.data('uid');let notesValue=$("#usernotes-text").val();gayware.api.call.user.note(userIdValue,notesValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});return false;},message:{delete:function(){let btnClicked=$(this);bootbox.confirm({message:"Do you really want to delete this message?",buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(result){if(result===true){let pmidValue=btnClicked.data('pmid');let tokenValue=btnClicked.data('token');gayware.api.call.user.message.delete(pmidValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.replace(document.location.protocol+'//'+document.location.host+'/forum/user/message')}});}}});},}},board:{read:function(){let btnClicked=$(this);let boardIdValue=btnClicked.data('fid');let boardParent=btnClicked.data('parent');gayware.api.call.board.read(boardIdValue,function(response){if(boardIdValue!==-1){if(boardParent===true){btnClicked.removeClass('board-icon-on');btnClicked.addClass('board-icon-off');}else{btnClicked.removeClass('board-child-icon-on');btnClicked.addClass('board-child-icon-off');}}});},collapse:{init:function(){console.log('init');let rawToggleList=gayware.cookie.get('AWTOGGLE');if(typeof rawToggleList!=='undefined'){let toggleList=JSON.parse(rawToggleList);for(let i=0;i<toggleList.length;i++){let boardId=toggleList[i];$('.board-collapse-'+boardId).toggle();$('[data-board-collapse][data-fid="'+boardId+'"]').html('<i class="fa fa-minus"></i>');}}},handle:function(){let btnClicked=$(this);let boardIdValue=btnClicked.data('fid');let sectionBoard=$('.board-collapse-'+boardIdValue);let isToggled=btnClicked.html()!=='<i class="fa fa-minus"></i>';sectionBoard.toggle('slow');btnClicked.html(isToggled?'<i class="fa fa-minus"></i>':'<i class="fa fa-plus"></i>');let rawToggleList=gayware.cookie.get('AWTOGGLE');if(typeof rawToggleList==='undefined'){gayware.cookie.set('AWTOGGLE',JSON.stringify([boardIdValue]));}else{let toggleList=JSON.parse(rawToggleList);let boardIdx=toggleList.indexOf(boardIdValue);if(isToggled){if(boardIdx===-1){toggleList.push(boardIdValue);}}else{if(boardIdx!==-1){toggleList.splice(boardIdx,1);}}
gayware.cookie.set('AWTOGGLE',JSON.stringify(toggleList));}}}},post:{approve:function(){let btnClicked=$(this);bootbox.confirm({message:"Do you really want to approve this post?",buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(result){if(result===true){let postIdValue=btnClicked.data('pid');let approveValue=btnClicked.data('approve');let tokenValue=btnClicked.data('token');gayware.api.call.post.approve(postIdValue,approveValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});}}});},delete:function(){let btnClicked=$(this);bootbox.confirm({message:"Do you really want to delete this post?",buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(result){if(result===true){let postIdValue=btnClicked.data('pid');let tokenValue=btnClicked.data('token');gayware.api.call.post.delete(postIdValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});}}});},},thread:{stick:function(){let btnClicked=$(this);let threadIdValue=btnClicked.data('tid');let stickValue=btnClicked.data('stick');let tokenValue=btnClicked.data('token');gayware.api.call.thread.stick(threadIdValue,stickValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});},close:function(){let btnClicked=$(this);let threadIdValue=btnClicked.data('tid');let closeValue=btnClicked.data('close');let tokenValue=btnClicked.data('token');gayware.api.call.thread.close(threadIdValue,closeValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});},approve:function(){let btnClicked=$(this);bootbox.confirm({message:"Do you really want to approve this thread?",buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(result){if(result===true){let threadIdValue=btnClicked.data('tid');let postIdValue=btnClicked.data('pid');let approveValue=btnClicked.data('approve');let tokenValue=btnClicked.data('token');gayware.api.call.post.approve(postIdValue,approveValue,tokenValue,function(response){});gayware.api.call.thread.approve(threadIdValue,approveValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.reload();}});}}});},delete:function(){let btnClicked=$(this);bootbox.confirm({message:"Do you really want to delete this thread?",buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(result){if(result===true){let threadIdValue=btnClicked.data('tid');let forumIdValue=btnClicked.data('fid');let tokenValue=btnClicked.data('token');gayware.api.call.thread.delete(threadIdValue,tokenValue,function(response){if(response.status===false){bootbox.alert(response.message);}else{document.location.replace(document.location.protocol+'//'+document.location.host+'/forum/board/'+forumIdValue);}});}}});},}},};